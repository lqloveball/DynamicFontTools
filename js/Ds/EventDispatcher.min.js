(function(b){var a=(typeof self=="object"&&self.self==self&&self)||(typeof global=="object"&&global.global==global&&global);if(typeof define==="function"&&define.amd){define(["exports"],function(c){module.exports=b(a,c)})}else{if(typeof exports!=="undefined"){module.exports=b(a,exports)}else{b(a,{})}}}(function(a,f){a.Ds=a.Ds||{};a.Ds.EventDispatcher=c;function c(){var h=this;this._eventMap={};this._eventByKeyMap={};this.addEventListener=function(k,l,j){var n=this._eventMap;var i=false;if(j!==undefined&&typeof(j)=="string"){i=true}if(i){n=this._eventByKeyMap}if(i){l.key=j}var m=n[k];if(m===null||m===undefined){m=n[k]=[]}if(m.indexOf(l)==-1){m.push(l);return true}return false};this.removeEventListener=function(n,o,m){var q=this._eventMap;var k=false;if(m!==undefined&&typeof(m)=="string"){k=true}if(k){q=this._eventByKeyMap}if(arguments.length==1){return this.removeEventListenerByType(n)}var p=q[n];if(p===null||p===undefined){return false}for(var l=0;l<p.length;l++){var j=p[l];if(j===o){if(k&&j.key!=m){console.warn("Error: removeEventListener Key Mismatch");return false}p.splice(l,1);if(p.length===0){delete q[n]}return true}}return false};this.removeEventListenerByType=function(o,n){var q=this._eventMap;var k=false;if(n!==undefined&&typeof(n)=="string"){k=true}if(k){q=this._eventByKeyMap}var p=q[o];if(p===null||p===undefined){return false}if(!k){if(p!==null&&p!==undefined){delete q[o];return true}}else{var l=false;for(var m=0;m<p.length;m++){var j=p[m];if(j.key==n){l=true;p.splice(m,1)}}return l}return false};this.removeAllEventListeners=function(){this._eventMap={}};this.dispatchEvent=function(k){if(typeof k=="string"){k={type:k}}var m=this._eventMap[k.type];var n=this._eventByKeyMap[k.type];if((m===null||m===undefined)&&(n===null||n===undefined)){return false}if(!k.target){k.target=this}var j=0;var l;if(m){m=m.slice();for(j=0;j<m.length;j++){l=m[j];if(typeof(l)=="function"){l.call(this,k)}}}if(n){n=m.slice();for(j=0;j<m.length;j++){l=n[j];if(typeof(l)=="function"){l.call(this,k)}}}return true};this.hasEventListener=function(i){var j=this._eventMap[i];return j};this.on=this.addEventListener;this.off=this.removeEventListener;this.ds=this.dispatchEvent}c.extend=function(h){a.Ds.Extend(h,new c())};a.Ds.Extend=g;a.Ds.ExtendNoCover=b;a.Ds.ExtendFactory=d;function e(j){var i=[];for(var h in j){i.push(h)}return i}function g(p){var n=arguments.length;if(n<2||p===null){return p}for(var j=1;j<n;j++){var o=arguments[j],q=e(o),h=q.length;for(var m=0;m<h;m++){var k=q[m];p[k]=o[k]}}return p}function d(h,j){var i=this;var l;if(h&&Object.prototype.hasOwnProperty.call(h,"constructor")){l=h.constructor}else{l=function(){return i.apply(this,arguments)}}g(l,i,j);var k=function(){this.constructor=l};k.prototype=i.prototype;l.prototype=new k();if(h){g(l.prototype,h)}l.__super__=i.prototype;return l}function b(j,i){for(var h in i){if(i[h]!==undefined&&j[h]===undefined){j[h]=i[h]}}return j}return a.Ds.EventDispatcher}));
